<p-toast></p-toast>

<div class="flex items-center justify-center p-8 min-h-screen bg-[#f5f7fa]">
  <p-card class="w-full max-w-[420px] bg-white rounded-2xl shadow-md p-8">

    <!-- Header -->
    <div class="text-center mb-4">
      <h2 class="text-blue-600 font-semibold text-xl">Signup</h2>
    </div>

    <form #registerForm="ngForm" (ngSubmit)="onRegister()" class="space-y-4">
      <!-- First Name -->
      <div>
        <input id="firstName" type="firstName" name="firstName" pInputText [(ngModel)]="firstName" #firstNameModel="ngModel" required
          placeholder="First name" [ngClass]="{ 'p-invalid': firstNameModel.invalid && (firstNameModel.touched || formSubmitted) }"
          class="w-full rounded-lg border border-gray-300 bg-[#fafbfc] px-4 py-3 text-base placeholder:text-gray-500 focus:outline-none focus:ring-0 focus:border-blue-500"
          style="::placeholder { color: #6b7280 !important; }" />
        <p-message *ngIf="firstNameModel.errors?.['required'] && (firstNameModel.touched || formSubmitted)" severity="error"
          text="Please enter your first name."></p-message>
      </div>

      <!-- Last Name -->
      <div>
        <input id="lastName" type="lastName" name="lastName" pInputText [(ngModel)]="lastName" #lastNameModel="ngModel" required
          placeholder="Last name" [ngClass]="{ 'p-invalid': lastNameModel.invalid && (lastNameModel.touched || formSubmitted) }"
          class="w-full rounded-lg border border-gray-300 bg-[#fafbfc] px-4 py-3 text-base placeholder:text-gray-500 focus:outline-none focus:ring-0 focus:border-blue-500" />
        <p-message *ngIf="lastNameModel.errors?.['required'] && (lastNameModel.touched || formSubmitted)" severity="error"
          text="Please enter your last name."></p-message>
      </div>

      <!-- Email -->
      <div>
        <input id="email" type="email" name="email" pInputText [(ngModel)]="email" #emailModel="ngModel" required email
          placeholder="Email" [ngClass]="{ 'p-invalid': emailModel.invalid && (emailModel.touched || formSubmitted) }"
          class="w-full rounded-lg border border-gray-300 bg-[#fafbfc] px-4 py-3 text-base placeholder:text-gray-500 focus:outline-none focus:ring-0 focus:border-blue-500" />
        <p-message *ngIf="emailModel.errors?.['required'] && (emailModel.touched || formSubmitted)" severity="error"
          text="Email is required."></p-message>

        <p-message *ngIf="emailModel.errors?.['email'] && (emailModel.touched || formSubmitted)" severity="error"
          text="Please enter a valid email address."></p-message>
      </div>

      <!-- Password -->
      <div>
        <p-password name="password" [(ngModel)]="password" #passwordModel="ngModel" required [minlength]="6"
          [feedback]="false" [toggleMask]="true" placeholder="Password" style="width: 100%;"
          [inputStyle]="{ width: '100%' }"
          [ngClass]="{ 'p-invalid': passwordModel.invalid && (passwordModel.touched || formSubmitted) }"></p-password>
        <p-message *ngIf="passwordModel.errors?.['required'] && (passwordModel.touched || formSubmitted)"
          severity="error" text="Password is required."></p-message>
        <p-message *ngIf="passwordModel.errors?.['minlength'] && (passwordModel.touched || formSubmitted)"
          severity="error" text="Password must be at least 6 characters."></p-message>
      </div>

      <!-- Confirm Password -->
      <div>
        <p-password id="confirmPassword" name="confirmPassword" [(ngModel)]="confirmPassword"
          #confirmPasswordModel="ngModel" (ngModelChange)="validatePasswordMatch()" [feedback]="false" required
          [toggleMask]="true" placeholder="Confirm password" style="width: 100%;" [inputStyle]="{ width: '100%' }"
          [ngClass]="{ 'p-invalid': (passwordMismatch && confirmPasswordModel.touched) || (passwordMismatch && formSubmitted) }"></p-password>
        <p-message *ngIf="passwordMismatch && (confirmPasswordModel.touched || formSubmitted)" severity="error"
          text="Passwords do not match."></p-message>
      </div>

      <!-- Submit -->
      <div>
        <button type="submit" [disabled]="loading"
          class="w-full bg-blue-600 text-white font-semibold text-base py-3 rounded-md hover:bg-blue-700 transition cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center">
          <span *ngIf="loading"
            class="mr-2 w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></span>
          <span>Signup</span>
        </button>
      </div>

      <!-- Link -->
      <div class="flex justify-center text-sm mt-2">
        <span class="text-gray-700">Already have an account?</span>
        <a class="ml-1 text-blue-600 no-underline text-sm cursor-pointer flex items-center" (click)="navigateToLogin()">
          <span *ngIf="loginLoading"
            class="mr-1 w-3 h-3 border-2 border-blue-600 border-t-transparent rounded-full animate-spin inline-block"></span>
          <span>Login</span>
        </a>
      </div>

      <!-- Divider -->
      <div class="flex items-center text-center my-6">
        <div class="flex-1 border-t border-gray-300"></div>
        <span class="mx-2 text-gray-500 text-xs">OR</span>
        <div class="flex-1 border-t border-gray-300"></div>
      </div>

      <!-- Google Button -->
      <div>
        <button type="button" [disabled]="googleLoading" (click)="loginWithGoogle()"
          class="flex items-center justify-center w-full h-12 border border-gray-300 rounded-md text-gray-700 text-base font-medium hover:bg-gray-100 transition cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">
          <span class="mr-2 flex items-center justify-center">
            <ng-container *ngIf="!googleLoading; else googleSpinner">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 533.5 544.3">
              <path fill="#4285f4" d="M533.5 278.4c0-17.4-1.4-34.1-4-50.2H272v95.1h146.9c-6.3 34-25 62.7-53.5 81.9v67h86.4c50.6-46.6 81.7-115.3 81.7-193.8z"/>
              <path fill="#34a853" d="M272 544.3c72.6 0 133.6-24 178.2-65.1l-86.4-67c-24 16.1-54.7 25.6-91.8 25.6-70.5 0-130.3-47.6-151.6-111.3h-89.4v69.9c44.8 88.4 137 148 241 148z"/>
              <path fill="#fbbc04" d="M120.4 326.5c-10.1-30-10.1-62.4 0-92.5v-69.9h-89.4c-38.6 76.4-38.6 166 0 242.4l89.4-69.9z"/>
              <path fill="#ea4335" d="M272 107.7c39.4-.6 77 13.5 106 39.5l79.3-79.3C412.2 24 345.4-.6 272 0 168.9 0 76.7 59.6 31 148l89.4 69.9C141.6 155.3 201.5 107.7 272 107.7z"/>
            </svg>
            </ng-container>
            <ng-template #googleSpinner>
              <span
                class="w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin inline-block"></span>
            </ng-template>
          </span>
          <span>Continue with Google</span>
        </button>
      </div>

    </form>
  </p-card>
</div>