<div class="min-h-screen bg-gray-50 p-6">
      <!-- Header -->
      <div class="mb-8 flex flex-col items-center">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Order Management</h1>
        <p class="text-gray-600">Manage and track all customer orders</p>
      </div>

      <!-- Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
          <div class="flex items-center">
            <div class="p-3 rounded-full bg-blue-100">
              <i class="pi pi-shopping-cart text-blue-600 text-xl"></i>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-600">Total Orders</p>
              <p class="text-2xl font-bold text-gray-900">{{ totalOrders }}</p>
            </div>
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
          <div class="flex items-center">
          
             <div class="p-3 rounded-full bg-yellow-100">
              <i class="pi pi-clock text-yellow-600 text-xl"></i>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-600">Processed</p>
              <p class="text-2xl font-bold text-gray-900">{{ processingOrders }}</p>
            </div>
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
          <div class="flex items-center">
             <div class="p-3 rounded-full bg-green-100">
              <i class="pi pi-check-circle text-green-600 text-xl"></i>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-600">Completed</p>
              <p class="text-2xl font-bold text-gray-900">{{ completedOrders }}</p>
            </div>
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
          <div class="flex items-center">
            <div class="p-3 rounded-full bg-purple-100">
              <i class="pi pi-dollar text-purple-600 text-xl"></i>
            </div>
            <div class="ml-4">
              <p class="text-sm font-medium text-gray-600">Total Revenue</p>
              <p class="text-2xl font-bold text-gray-900">${{ totalRevenue | number:'1.2-2' }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Filters and Search -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6 ">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Search Orders</label>
            <span class="p-input-icon-left w-full">
              <input type="text" 
                     pInputText 
                     placeholder="Search by ID, customer..." 
                     [(ngModel)]="searchQuery"
                     (input)="onSearch()"
                     class="w-full">
            </span>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Status Filter</label>
            <select [(ngModel)]="selectedStatus" 
                    (change)="onStatusFilter()"
                    class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option [value]="null">All Statuses</option>
              <option [value]="'PENDING'">Pending</option>
              <option [value]="'CONFIRMED'">Confirmed</option>
              <option [value]="'PROCESSING'">Processing</option>
              <option [value]="'SHIPPED'">Shipped</option>
              <option [value]="'DELIVERED'">Delivered</option>
              <option [value]="'CANCELLED'">Cancelled</option>
              <option [value]="'COMPLETED'">Completed</option>
            </select>
          </div>
          
          <div class="grid grid-cols-2 gap-2">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">From Date</label>
              <input type="date" 
                     [(ngModel)]="fromDate"
                     (change)="onDateFilter()"
                     class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">To Date</label>
              <input type="date" 
                     [(ngModel)]="toDate"
                     (change)="onDateFilter()"
                     class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            </div>
          </div>
          
          <div class="flex items-end">
            <button pButton 
                    type="button" 
                    label="Clear Filters" 
                    icon="pi pi-filter-slash" 
                    class="p-button-outlined w-full"
                    (click)="clearFilters()">
            </button>
          </div>
        </div>
      </div>

      <!-- Orders Table -->
      <div class="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
       <p-table
            [value]="orders"
            [paginator]="true"
            [rows]="size"
            [totalRecords]="totalRecords"
            [loading]="loading"
            [rowsPerPageOptions]="[5,10,15]"
            [lazy]="true"
            (onLazyLoad)="loadOrdersLazy($event)"
            styleClass="p-datatable-gridlines">

                 >
          
          <ng-template pTemplate="header">
            <tr>
              <th class="bg-gray-50 text-left py-4 px-6 font-semibold text-gray-700">Order ID</th>
              <th class="bg-gray-50 text-left py-4 px-6 font-semibold text-gray-700">Customer</th>
              <th class="bg-gray-50 text-left py-4 px-6 font-semibold text-gray-700">Products</th>
              <th class="bg-gray-50 text-left py-4 px-6 font-semibold text-gray-700">Amount</th>
              <th class="bg-gray-50 text-left py-4 px-6 font-semibold text-gray-700">Status</th>
              <th class="bg-gray-50 text-left py-4 px-6 font-semibold text-gray-700">Date</th>
              <th class="bg-gray-50 text-center py-4 px-6 font-semibold text-gray-700">Actions</th>
            </tr>
          </ng-template>
          
          <ng-template pTemplate="body" let-order>
            <tr class="hover:bg-gray-50 transition-colors">
              <td class="py-4 px-6">
                <div class="font-mono text-sm text-gray-900">
                  {{ order.id | slice:0:8 }}...
                </div>
              </td>
              
              <td class="py-4 px-6">
                <div class="font-medium text-gray-900">
                  {{ order.customerId | slice:0:8 }}...
                </div>
              </td>
              
              <td class="py-4 px-6">
                <div class="flex items-center">
                  <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                    {{ getTotalProductCount(order.orderProducts) }} items
                  </span>
                </div>
              </td>
              
              <td class="py-4 px-6">
                <div class="font-semibold text-gray-900">
                  \${{ order.totalAmount | number:'1.2-2' }}
                </div>
                <div *ngIf="order.couponCode" class="text-xs text-green-600">
                  Coupon: {{ order.couponCode }}
                </div>
              </td>
              
              <td class="py-4 px-6">
                <span [class]="getStatusClass(order.status)" 
                      class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium">
                  {{ order.status }}
                </span>
              </td>
              
              <td class="py-4 px-6">
                <div class="text-sm text-gray-900">
                  {{ order.createdAt | date:'MMM d, y' }}
                </div>
                <div class="text-xs text-gray-500">
                  {{ order.createdAt | date:'h:mm a' }}
                </div>
              </td>
              
              <td class="py-4 px-6 text-center">
                <div class="flex justify-center space-x-2">
                  <button pButton 
                          type="button" 
                          icon="pi pi-eye" 
                          class="p-button-rounded p-button-outlined p-button-sm"
                          pTooltip="View Details"
                          (click)="viewOrderDetails(order)">
                  </button>
                  
                  <button pButton 
                          type="button" 
                          icon="pi pi-pencil" 
                          class="p-button-rounded p-button-outlined p-button-sm p-button-warning"
                          pTooltip="Update Status"
                          (click)="openStatusDialog(order)">
                  </button>
                  
                </div>
              </td>
            </tr>
          </ng-template>
          
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="7" class="text-center py-8">
                <div class="flex flex-col items-center">
                  <i class="pi pi-inbox text-4xl text-gray-400 mb-4"></i>
                  <p class="text-gray-500 text-lg">No orders found</p>
                  <p class="text-gray-400 text-sm">Try adjusting your search criteria</p>
                </div>
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>

      <!-- Update Status Dialog -->
      <p-dialog header="Update Order Status" 
                [(visible)]="statusDialogVisible" 
                [modal]="true" 
                [style]="{width: '800px'}"
                [closable]="true">
        <div class="flex flex-col space-y-4" *ngIf="selectedOrder">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Order ID</label>
            <input type="text" 
                   pInputText 
                   [value]="selectedOrder.id" 
                   [readonly]="true"
                   class="w-full bg-gray-50">
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Current Status</label>
            <span [class]="getStatusClass(selectedOrder.status)" 
                  class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium">
              {{ selectedOrder.status }}
            </span>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">New Status</label>
            <select [(ngModel)]="newStatus" 
                    class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
              <option value="">Select new status</option>
              <option [value]="'CONFIRMED'">Confirmed</option>
              <option [value]="'PROCESSING'">Processing</option>
              <option [value]="'SHIPPED'">Shipped</option>
              <option [value]="'DELIVERED'">Delivered</option>
              <option [value]="'CANCELLED'">Cancelled</option>
              <option [value]="'COMPLETED'">Completed</option>
            </select>
          </div>
        </div>
        
        <ng-template pTemplate="footer">
          <button pButton 
                  type="button" 
                  label="Cancel" 
                  icon="pi pi-times" 
                  class="p-button-text"
                  (click)="statusDialogVisible = false">
          </button>
          <button pButton 
                  type="button" 
                  label="Update" 
                  icon="pi pi-check" 
                  [loading]="updating"
                  [disabled]="!newStatus"
                  (click)="updateOrderStatus()">
          </button>
        </ng-template>
      </p-dialog>

      <!-- Order Details Dialog -->
      <p-dialog header="Order Details" 
                [(visible)]="detailsDialogVisible" 
                [modal]="true" 
                [style]="{width: '800px'}"
                [closable]="true">
        <div *ngIf="selectedOrder" class="space-y-6">
          <!-- Order Info -->
          <div class="grid grid-cols-2 gap-4">
            <div>
              <h3 class="font-semibold text-gray-700 mb-2">Order Information</h3>
              <div class="space-y-2 text-sm">
                <div><span class="font-medium">Order ID:</span> {{ selectedOrder.id }}</div>
                <div><span class="font-medium">Customer ID:</span> {{ selectedOrder.customerId }}</div>
                <div><span class="font-medium">Transaction ID:</span> {{ selectedOrder.transactionId }}</div>
                <div><span class="font-medium">Date:</span> {{ selectedOrder.createdAt | date:'medium' }}</div>
              </div>
            </div>
            
            <div>
              <h3 class="font-semibold text-gray-700 mb-2">Order Summary</h3>
              <div class="space-y-2 text-sm">
                <div><span class="font-medium">Status:</span> 
                  <span [class]="getStatusClass(selectedOrder.status)" 
                        class="ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium">
                    {{ selectedOrder.status }}
                  </span>
                </div>
                <div><span class="font-medium">Total Amount:</span> ${{ selectedOrder.totalAmount | number:'1.2-2' }}</div>
                <div *ngIf="selectedOrder.couponCode"><span class="font-medium">Coupon:</span> {{ selectedOrder.couponCode }}</div>
              </div>
            </div>
          </div>
          
          <!-- Products -->
          <div>
            <h3 class="font-semibold text-gray-700 mb-3">Order Products</h3>
            <div class="border rounded-lg overflow-hidden">
              <table class="w-full">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Product ID</th>
                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Quantity</th>
                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Store ID</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let product of selectedOrder.orderProducts" class="border-t">
                    <td class="px-4 py-2 text-sm font-mono">{{ product.productId | slice:0:8 }}...</td>
                    <td class="px-4 py-2 text-sm">{{ product.quantity }}</td>
                    <td class="px-4 py-2 text-sm font-mono">{{ product.storeId | slice:0:8 }}...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </p-dialog>
    </div>

    <p-toast></p-toast>
    <p-confirmDialog></p-confirmDialog>